label "Debug Settings"
title "Debug Settings"

accesslevel internal

storage state
setmode edit

summary {Enable debug settings}
help {Enables various debug settings useful during development}

ifmodified_message

bar "Debug Settings"

field enable {
	label "Enable Debug Logging"
	type boolean
	help {If enabled, debug logging is enabled to stderr}
}
field debuglog {
	storage custom
	storagename log.debug
	label "Application Debug"
	type boolean
	help {If enabled, local1.debug messages are sent to the application log}
}

field cgi {
	label "Enable CGI Debug"
	type boolean
	help {If enabled, a summary of the CGI state is displayed at the end of each page}
}

field log {
	label "Custom Log Setting"
	editmode size=40 maxlength=200
	help {Set custom log settings. e.g. +debug,+file=+/tmp/out.log,cgi}
}

button submit {
	label Submit
	editmode newline
	submit {
		save_config
		cgi success "Settings updated"
	}
}

bar "Debug Status"

text {
	display {
		cgi display row {
			#html tag hr
			html str h3 "CGI Environment"
			html eval table {
				array set cgienv [cgi getenv]
				foreach e [lsort [array names cgienv]] {
					html eval tr {
						html str td $e
						html str td $cgienv($e)
					}
				}
			}
		}
		cgi display row {
			html tag hr
			html str h3 "Application Environment"
			html eval table {
				foreach e [lsort [array names ::env]] {
					html eval tr {
						html str td $e
						html str td $::env($e)
					}
				}
			}
		}
	}
}
