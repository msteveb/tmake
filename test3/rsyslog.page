title "Remote Logging"
label "Logging"
help {Configure remote syslog}

accesslevel status

head {
<style>
div.elemlabel { width: 14em; }
</style>
}

ifmodified_message

bar "Syslog Settings"

text {
	display display_page_help
}

field enable {
	storagename log.rsyslog
	label "Enable Remote Syslog"
	type boolean
	default 0
	help {Enable or disable logging to remote hosts via the syslog protocol}
	display display_field_help
}

field remote {
	storagename log.remote
	label "Syslog Hosts"
	help {The space-separated list of IP address or hostname destinations}
	#type iphostlist blank
	#type text
	editmode size=80
	display {
		display_unset
		display_field_help
	}
}

button submit {
	label Submit
	stdmode none
	submit {
		package require validation
		foreach error [is_valid_listof [cgi get remote] {hostname ipaddr}] {
			cgi error $error remote
		}

		if {[cgi get enable]} {
			if {[cgi get remote] eq ""} {
				cgi warning "Remote syslog is enabled but no remote hosts are set"
			}
		}
		save_config
	}
}

button edit {
	label Edit
	editmode none
	setmode edit
}

button cancel {
	label Cancel
	stdmode none
}
